Welcome to my joystick code, I hope my comments are comprehensible.

I am using a teensy (https://www.pjrc.com/store/teensy41.html) which is programmed using the Arduino IDE.
Teensy's are natively HIDs and can be purchased with no pre-soldered pins which could prove useful.
A Teensy 4.0 has 24 easily usable pins for buttons and 14 analog compatible pins.
The Teensy 4.1 has 42 pins with 18 being analog compatible.
Any multi-position switches that may be used will take up additional buttons both on the microcontroller and on the joystick in Windows.
